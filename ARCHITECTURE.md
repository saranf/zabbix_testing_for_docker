# ğŸ—ï¸ ì•„í‚¤í…ì²˜ ë¬¸ì„œ

## ì‹œìŠ¤í…œ êµ¬ì„±ë„

```
Internet
    â†“
[Port 80/443]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  zabbix-reverse-proxy (Nginx)          â”‚
â”‚  - HTTPS ê°•ì œ                           â”‚
â”‚  - ë³´ì•ˆ í—¤ë”                            â”‚
â”‚  - Rate Limiting                        â”‚
â”‚  - SSL/TLS 1.2+                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  zabbix-web (Zabbix Web UI)            â”‚
â”‚  - PHP + Nginx                          â”‚
â”‚  - Port 8080 (ë‚´ë¶€ë§Œ)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  zabbix-server (Zabbix Server)         â”‚
â”‚  - Port 10051 (ë‚´ë¶€)                    â”‚
â”‚  - Port 10847 (ì™¸ë¶€ - Agent í†µì‹ )      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  postgres-server (PostgreSQL)           â”‚
â”‚  - Port 5432 (ë‚´ë¶€ë§Œ)                   â”‚
â”‚  - ë°ì´í„° ì˜êµ¬ ì €ì¥                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  certbot (SSL ì¸ì¦ì„œ ê´€ë¦¬)              â”‚
â”‚  - ìë™ ë°œê¸‰                            â”‚
â”‚  - ìë™ ê°±ì‹  (12ì‹œê°„ë§ˆë‹¤ ì²´í¬)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  zabbix-agent (ìì²´ ëª¨ë‹ˆí„°ë§)           â”‚
â”‚  - Zabbix ì„œë²„ ìì²´ ëª¨ë‹ˆí„°ë§            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Docker ë„¤íŠ¸ì›Œí¬ êµ¬ì„±

### zabbix-network (Bridge)

ëª¨ë“  ì»¨í…Œì´ë„ˆëŠ” ê²©ë¦¬ëœ Docker ë„¤íŠ¸ì›Œí¬ì—ì„œ í†µì‹ í•©ë‹ˆë‹¤.

**ë‚´ë¶€ í†µì‹ ë§Œ í—ˆìš©**:
- `postgres-server:5432` - ë°ì´í„°ë² ì´ìŠ¤
- `zabbix-web:8080` - ì›¹ UI
- `zabbix-server:10051` - ì„œë²„ ë‚´ë¶€ í¬íŠ¸

**ì™¸ë¶€ ë…¸ì¶œ í¬íŠ¸**:
- `80` - HTTP (HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸)
- `443` - HTTPS (Nginx Reverse Proxy)
- `10847` - Zabbix Server (Agent í†µì‹ ìš©)

---

## ì»¨í…Œì´ë„ˆ ìƒì„¸ ì •ë³´

### 1. zabbix-reverse-proxy (Nginx)

**ì´ë¯¸ì§€**: `nginx:alpine`  
**ì—­í• **: ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ë° ë³´ì•ˆ ê²Œì´íŠ¸ì›¨ì´

**ì£¼ìš” ê¸°ëŠ¥**:
- HTTPS ê°•ì œ (HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸)
- SSL/TLS 1.2+ ì•”í˜¸í™”
- ë³´ì•ˆ í—¤ë” ì¶”ê°€ (HSTS, CSP, X-Frame-Options ë“±)
- Rate Limiting (DDoS ë°©ì§€)
- ë¡œê·¸ì¸ í˜ì´ì§€ ì¶”ê°€ ë³´í˜¸
- ì •ì  íŒŒì¼ ìºì‹±
- ë¯¼ê°í•œ íŒŒì¼ ì ‘ê·¼ ì°¨ë‹¨

**ë³¼ë¥¨**:
- `./nginx/nginx.conf` â†’ `/etc/nginx/nginx.conf` (ì½ê¸° ì „ìš©)
- `./nginx/conf.d` â†’ `/etc/nginx/conf.d` (ì½ê¸° ì „ìš©)
- `./certbot/conf` â†’ `/etc/letsencrypt` (SSL ì¸ì¦ì„œ)
- `nginx-logs` â†’ `/var/log/nginx` (ë¡œê·¸)

---

### 2. zabbix-web (Zabbix Web UI)

**ì´ë¯¸ì§€**: `zabbix/zabbix-web-nginx-pgsql:alpine-6.4-latest`  
**ì—­í• **: Zabbix ì›¹ ì¸í„°í˜ì´ìŠ¤

**ì£¼ìš” ê¸°ëŠ¥**:
- PHP ê¸°ë°˜ ì›¹ UI
- PostgreSQL ì—°ê²°
- ë‚´ë¶€ Nginx ì„œë²„ (í¬íŠ¸ 8080)

**í™˜ê²½ ë³€ìˆ˜**:
- `ZBX_SERVER_HOST`: zabbix-server
- `DB_SERVER_HOST`: postgres-server
- `PHP_TZ`: Asia/Seoul

---

### 3. zabbix-server (Zabbix Server)

**ì´ë¯¸ì§€**: `zabbix/zabbix-server-pgsql:alpine-6.4-latest`  
**ì—­í• **: ëª¨ë‹ˆí„°ë§ ì„œë²„ ì½”ì–´

**ì£¼ìš” ê¸°ëŠ¥**:
- ë°ì´í„° ìˆ˜ì§‘ ë° ì²˜ë¦¬
- íŠ¸ë¦¬ê±° í‰ê°€
- ì•Œë¦¼ ë°œì†¡
- SNMP Trap ì§€ì›

**í¬íŠ¸**:
- `10051` (ë‚´ë¶€) - ì›¹ UI í†µì‹ 
- `10847` (ì™¸ë¶€) - Agent í†µì‹ 

---

### 4. postgres-server (PostgreSQL)

**ì´ë¯¸ì§€**: `postgres:15-alpine`  
**ì—­í• **: ë°ì´í„°ë² ì´ìŠ¤

**ì£¼ìš” ê¸°ëŠ¥**:
- Zabbix ë°ì´í„° ì €ì¥
- ì„¤ì • ì •ë³´ ì €ì¥
- íˆìŠ¤í† ë¦¬ ë°ì´í„° ì €ì¥

**ë³´ì•ˆ**:
- ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ì™¸ë¶€ í¬íŠ¸ ë…¸ì¶œ ì—†ìŒ

**ë³¼ë¥¨**:
- `postgres-data` - ë°ì´í„° ì˜êµ¬ ì €ì¥

---

### 5. certbot (SSL ì¸ì¦ì„œ ê´€ë¦¬)

**ì´ë¯¸ì§€**: `certbot/certbot:latest`  
**ì—­í• **: SSL ì¸ì¦ì„œ ìë™ ê´€ë¦¬

**ì£¼ìš” ê¸°ëŠ¥**:
- Let's Encrypt ì¸ì¦ì„œ ë°œê¸‰
- 12ì‹œê°„ë§ˆë‹¤ ê°±ì‹  ì²´í¬
- ë§Œë£Œ 30ì¼ ì „ ìë™ ê°±ì‹ 

**ë³¼ë¥¨**:
- `./certbot/conf` - ì¸ì¦ì„œ ì €ì¥
- `./certbot/www` - ACME Challenge

---

### 6. zabbix-agent (Zabbix Agent)

**ì´ë¯¸ì§€**: `zabbix/zabbix-agent:alpine-6.4-latest`  
**ì—­í• **: Zabbix ì„œë²„ ìì²´ ëª¨ë‹ˆí„°ë§

**ì£¼ìš” ê¸°ëŠ¥**:
- Zabbix ì„œë²„ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§
- CPU, ë©”ëª¨ë¦¬, ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰ ì¶”ì 

---

## ë°ì´í„° ë³¼ë¥¨

| ë³¼ë¥¨ ì´ë¦„ | ìš©ë„ | í¬ê¸° ì˜ˆìƒ |
|-----------|------|-----------|
| `postgres-data` | PostgreSQL ë°ì´í„° | ì¦ê°€ (íˆìŠ¤í† ë¦¬ ë°ì´í„°) |
| `zabbix-server-data` | Zabbix ì„œë²„ ë°ì´í„° | ì†ŒëŸ‰ |
| `zabbix-web-data` | ì›¹ UI ë°ì´í„° | ì†ŒëŸ‰ |
| `zabbix-snmptraps` | SNMP Trap ë°ì´í„° | ì†ŒëŸ‰ |
| `nginx-logs` | Nginx ë¡œê·¸ | ì¦ê°€ (ë¡œê·¸ ë¡œí…Œì´ì…˜ ê¶Œì¥) |

---

## ë³´ì•ˆ ê³„ì¸µ

### Layer 1: ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
- Docker ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬
- ìµœì†Œ í¬íŠ¸ ë…¸ì¶œ
- ë‚´ë¶€ ì„œë¹„ìŠ¤ ì™¸ë¶€ ì ‘ê·¼ ì°¨ë‹¨

### Layer 2: SSL/TLS ë³´ì•ˆ
- TLS 1.2+ ê°•ì œ
- ê°•ë ¥í•œ ì•”í˜¸í™” ìŠ¤ìœ„íŠ¸
- OCSP Stapling
- Perfect Forward Secrecy

### Layer 3: ì• í”Œë¦¬ì¼€ì´ì…˜ ë³´ì•ˆ
- ë³´ì•ˆ í—¤ë” (HSTS, CSP, X-Frame-Options ë“±)
- Rate Limiting
- íŒŒì¼ ì ‘ê·¼ ì œì–´
- ì„œë²„ ì •ë³´ ìˆ¨ê¹€

### Layer 4: ë°ì´í„° ë³´ì•ˆ
- ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸ ë³´í˜¸
- í™˜ê²½ ë³€ìˆ˜ ë¶„ë¦¬ (.env)
- ì½ê¸° ì „ìš© ì„¤ì • íŒŒì¼

---

## ì„±ëŠ¥ ìµœì í™”

### Nginx
- Gzip ì••ì¶• í™œì„±í™”
- ì •ì  íŒŒì¼ ìºì‹± (7ì¼)
- Keepalive ì—°ê²°
- ë²„í¼ ìµœì í™”

### PostgreSQL
- ì—°ê²° í’€ë§
- ì¸ë±ìŠ¤ ìµœì í™” (Zabbix ê¸°ë³¸ ì œê³µ)

### Zabbix
- Poller í”„ë¡œì„¸ìŠ¤ ìµœì í™”
- íˆìŠ¤í† ë¦¬ ë°ì´í„° ë³´ê´€ ê¸°ê°„ ì„¤ì •

---

## í™•ì¥ì„±

### ìˆ˜í‰ í™•ì¥
- Zabbix Proxy ì¶”ê°€ ê°€ëŠ¥
- ë°ì´í„°ë² ì´ìŠ¤ ë³µì œ ê°€ëŠ¥
- Nginx ë¡œë“œ ë°¸ëŸ°ì‹± ê°€ëŠ¥

### ìˆ˜ì§ í™•ì¥
- ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ì œí•œ ì¡°ì •
- PostgreSQL ë©”ëª¨ë¦¬ ì„¤ì • ì¡°ì •
- Zabbix í”„ë¡œì„¸ìŠ¤ ìˆ˜ ì¦ê°€

---

## ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…

### ë¡œê·¸ ìœ„ì¹˜
- Nginx: `docker-compose logs zabbix-reverse-proxy`
- Zabbix Server: `docker-compose logs zabbix-server`
- Zabbix Web: `docker-compose logs zabbix-web`
- PostgreSQL: `docker-compose logs postgres-server`

### Health Check
ëª¨ë“  ì»¨í…Œì´ë„ˆì— í—¬ìŠ¤ì²´í¬ ì„¤ì •:
- ìë™ ë³µêµ¬
- ìƒíƒœ ëª¨ë‹ˆí„°ë§
- ì˜ì¡´ì„± ê´€ë¦¬

---

## ë°±ì—… ì „ëµ

### ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
```bash
docker-compose exec postgres-server pg_dump -U zabbix zabbix > backup.sql
```

### ì„¤ì • ë°±ì—…
```bash
tar -czf backup.tar.gz docker-compose.yml .env nginx/ certbot/
```

### ë³µì›
```bash
docker-compose exec -T postgres-server psql -U zabbix zabbix < backup.sql
```

---

## ì—…ê·¸ë ˆì´ë“œ ì ˆì°¨

1. ë°±ì—… ìˆ˜í–‰
2. ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
   ```bash
   docker-compose pull
   ```
3. ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
   ```bash
   docker-compose down
   docker-compose up -d
   ```
4. ë¡œê·¸ í™•ì¸
   ```bash
   docker-compose logs -f
   ```

---

## ë¬¸ì œ í•´ê²°

### ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
```bash
docker-compose restart [service-name]
```

### ë¡œê·¸ í™•ì¸
```bash
docker-compose logs -f [service-name]
```

### ì™„ì „ ì¬ì„¤ì¹˜
```bash
docker-compose down -v
docker-compose up -d
```

---

**ë” ìì„¸í•œ ì •ë³´**:
- [README.md](README.md) - ì„¤ì¹˜ ê°€ì´ë“œ
- [SECURITY.md](SECURITY.md) - ë³´ì•ˆ ì„¤ì •
- [QUICKSTART.md](QUICKSTART.md) - ë¹ ë¥¸ ì‹œì‘

